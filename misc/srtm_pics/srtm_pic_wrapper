#!/bin/sh -efu

while read name style geom; do
  [ -n "${name%%*#}" ] || continue

  if [ -n "$1" ]; then
    [ "$1" = "$name" ] || continue
  fi

  echo "<<$name>>"
  [ "$style" = "podm" ] && steps="10 10" || steps="50 50"
  ./srtm_pic 1e-5 200 $geom $steps $style > $name.pnm
  pnmquant 255 < $name.pnm | pnmtopng > $name.png
  rm -f $name.pnm
done <<EOF
  munku hr 99 564000 624000 5728000 5748000

  giss_test hr 69 436000 440000 4310000 4316000
  giss hr  69 436000 464000 4310000 4322000
  fany hr  69 424000 448000 4326000 4348000
  elbr hr  45 292000 318000 4796000 4814000
  puto hr  93 428000 484000 7652000 7744000
  wakh hr  75 300000 376000 4092000 4130000
  krop hr  99 540000 600000 5850000 5880000
  barg hr  111 454000 484000 6042000 6112000
  cpam hr  75 230000 294000 4240000 4292000
  tunk hr  99 660000 736000 5740000 5768000
  fany1 hr 69 390000 490000 4300000 4360000
  fany2 hr 69 430000 440000 4335000 4345000
  takal hr 69 532000 588000 4318000 4396000
  rush  hr 75 230000 330000 4170000 4246000

  sosna podm  39 308000 468000 5800000 5884000
  sosna2 podm  39 452000 524000 5820000 5908000
  sosna1 podm  39 432000 464000 5808000 5832000
  sosna_test podm  39 432000 436000 5808000 5814000

  osetr podm   39 440000 472000 6020000 6044000
  kaluzh podm  39 328000 396000 6028000 6052000
  tarusa podm  39 380000 392000 6052000 6080000
  nosetr podm   39 464000 490000 6072000 6096000
  sosna3 podm   39 432000 504000 5784000 5832000

  don1 podm   39 472000 496000 5836000 5848000
  kshen podm   39 388000 436000 5792000 5816000
  derzha podm   33 608000 622000 6228000 6268000

EOF